# ML System Design Doc - [RU]

## Дизайн ML системы - negotiations trainer MVP 0.1.0

### 1. Цели и предпосылки

#### 1.1. Зачем идем в разработку продукта?

**Бизнес-цель**  
Создать полностью автоматический тренажер, который позволит пользователям участвовать в симуляциях различных бизнес-кейсов, развивая и улучшая навыки ведения переговоров.

**Почему станет лучше, чем сейчас, от использования ML**  
В текущий момент обучение переговорам чаще всего происходит в формате очных мероприятий, организуемых MBA программами и другими образовательными платформами. Эти мероприятия ограничены временем, местом, и требуют наличия партнера для участия в симуляции. Использование ML позволит:
- Устранить временные и территориальные ограничения.
- Автоматизировать процесс тренировки, позволяя работать в одиночку.
- Снизить стоимость обучения.
- Масштабироваться.

**Что будем считать успехом итерации с точки зрения бизнеса**  
- Разработка работающего интерфейса, через который пользователь сможет участвовать в нескольких бизнес-кейсах.  
- Высокое качество работы ML-агентов:
  - Реалистичное поведение и манера общения.
  - Минимизация "галлюцинаций" (некорректных предложений или ответов).
  - Умение следовать заданным паттернам переговоров без ухудшения собственной позиции.
- Улучшение переговорных скилов пользователем после использования системы.

#### 1.2. Бизнес-требования и ограничения

**Бизнес-требования:**
- Возможность участвовать в симуляции с несколькими соперниками.
- Возможность проходить симуляцию в телеграме.
- Возможность взаимодействовать с ML-агентами с разными типами поведения (агрессивный, умеренный и избегающий).
  - "агрессивный тип": переговорщик-террорист, который остро реагирует на изменения и готов рискнуть и получить ничего. Часто выдвигает ультиматумы.
  - "избегающий": переговорщик, избегающий споров, легко идущий на уступки, на обостряет переговоры.
  - "умеренный": среднее между предыдущими двумя.
- Возможность участвовать симуляциях нескольких бизнес-кейсов.
- Возможность поиска партнеров для симуляции бизнес-кейса.
- Фидбек системы с слабых и сильных сторон пользователя.

**Бизнес-ограничения:**
- Система должна быть доступна круглосуточно.
- Время ответа ML-агентов не должно превышать 10-15 секунд.
- Возможность возвращения к незавершенному кейсу.
- Симуляция поведения человека с реалистичной манерой общения.
- Отсутствие ухудшения переговорных позиций агентов из-за своих же действий.
- Среднее улучшение результатов пользователя после нескольких тренировок.
- Обеспечение безопасности данных пользователей.

**Что мы ожидаем от конкретной итерации?**
- Прототип работающего Telegram-интерфейса.
- Один бизнес-кейс (игра ABC) с поддержкой "умеренного" типа поведения ML-агентов.
- Отзывы пользователей для проверки корректности симуляций и моделей поведения агентов, собранные в процессе бета-тестирования.

**Что считаем успешным пилотом?**
- Пользователи могут завершить кейс без значительных ошибок системы.
- ML-агенты корректно имитируют манеры общения.
- Пользователи отмечают улучшение навыков переговоров.

#### 1.3. Что входит в скоуп проекта/итерации

**На закрытие каких бизнес-требований подписываемся в данной итерации:**
- Прототип работающего Telegram-интерфейса.
- Один бизнес-кейс (игра ABC) с поддержкой "умеренного" типа поведения ML-агентов.
- Отзывы пользователей для проверки корректности симуляций и моделей поведения агентов, собранные в процессе бета-тестирования.

**Что не будет закрыто:**
- Полная библиотека бизнес-кейсов.
- Оптимизация производительности системы для масштабирования.
- Разный тип поведения агентов.
- Фидбек системы.

**Описание результата с точки зрения качества кода и воспроизводимости решения:**
- Код будет задокументирован.
- Решение поддерживает запуск на локальной машине и в облаке.
- Скрипты тестирования агентов воспроизводимы.

**Описание планируемого технического долга:**
- Ограниченная функциональность кейсов.
- Базовые шаблоны поведения ML-агентов без глубокой персонализации.
- Ограниченный тип поведения ML-агентов.
- Отсутствие фидбека с разбором кейса.

#### 1.4. Предпосылки решения
- Доступные бизнес-кейсы для предобработки.
- Технологическая база для реализации Telegram-бота.
- Доступные LLM модели.
- Доступные фреймворки для взаимодействия агентов между собой: [camel-ai](https://www.camel-ai.org/)

---

### 2. Методология Data Scientist

#### 2.1. Постановка задачи
**Цель:** Разработка ML-агентов для симуляции переговоров в автоматическом режиме.  
**Подзадачи:**
- Предобработка бизнес-кейсов.
- Настройка симуляции на основе существующего фреймворка ([camel-ai](https://www.camel-ai.org/)) для взаимодействия нескольких агентов.
- Создание телеграм бота - интерфейса для симуляции.
- Проверка корректности поведения агентов через тестовые сценарии. Для оценки будем использовать
  - пользовательский фидбек.
  - юнит тесты, которые будут проверять реалистичность предлагаемой сделки.

**Критерии успеха:**
- Агенты демонстрируют согласованное поведение.
  - 80% решений пользователь расценивает как логичные.
- Время отклика агентов не превышает 15 секунд.
- Пользователь отмечает реалистичность и ценность симуляции.
  - 70% симуляций оцениваются пользователем на хотя бы 4 из 5.
  - 70% техник для ведения переговоров при их использовании улучшают результат симуляции  .

#### 2.2. Блок-схема решения

![scheme](images/block-scheme.png)

#### 2.3 Этапы решения задачи

*Этап 1. EDA и Подготовка данных*

На данной итерации мы не будем дообучать агентов, поэтому данных для обучения нету. Но есть данные кейсов, которые тоже необходимо предобработать.

Каждый кейс предобрабатываем руками (по условиям текущей итерации - далее будем добавлять автоматизацию). Из кейса выделяем:
* Общая информация (предыстория, правила игры и т.д.)
* Описание каждой из ролей (начальная позиция, цели, характер, описание метрики и т.д.)
Эта информация будет передана в промпты к агентам и как вводная информация для пользователя.

На данной итерации были подготовлены данные для 2 кейсов:
1) [**ABC**](cases/abc/) - простой переговорный кейс, [описание](cases/abc/description.md)
2) [**Sales**](cases/sales/) - кейс, для тренировки sales-ов на основе продажи ПО (человек - sales, AI агент - покупатель). Для данного кейса был проведен анализ и составлены
* [Описание кейса и продукта](cases/sales/description.md)
* [Сценарий перегворов](cases/sales/negotiations_scheme.md)
* [Портреты покупателей на основе отзывов](cases/sales/buyer_profile.md)
* [Болевые точки покупателей в диалоге](cases/sales/buyer_pain_points.md)
* [Ключевые черты и навыки продавцов](cases/sales/sales_profile.md)
* [Примерный диалог на основе отзывов](cases/sales/negotiations_example.md)
